# todo
understand every line of middleware properly